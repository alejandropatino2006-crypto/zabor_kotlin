server {
    listen 80;
    listen [::]:80;
    #listen 443;
    #listen [::]:443;
    server_name www.zaboreats.com;
    return 301 $scheme://zaboreats.com$request_uri;
}

server {
    listen 80;
    listen [::]:80;
    server_name zaboreats.com;
    return 301 https://$host$request_uri;
}

server {
    http2 on;
    listen 443 ssl;
    listen [::]:443 ssl;

    server_name zaboreats.com;
#     server_name _;

    #add_header X-Frame-Options DENY;
    add_header X-Frame-Options SAMEORIGIN;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Referrer-Policy "origin";

    root /app/site/zabor-app;
    index index.html index.htm index.nginx-debian.html;

    ssl_certificate /etc/letsencrypt/live/www.zaboreats.com/cert.pem;
    ssl_certificate_key /etc/letsencrypt/live/www.zaboreats.com/privkey.pem;
    include /etc/nginx/options-ssl-nginx.conf;
#     #ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
#     #ssl_stapling on;
#     #ssl_stapling_verify on;
    resolver 8.8.8.8 8.8.4.4 valid=600s;
    resolver_timeout 5s;
    ssl_trusted_certificate /etc/letsencrypt/live/www.zaboreats.com/chain.pem;

    #error_log  /var/log/nginx/zabor-app-error.log;
    #access_log /var/log/nginx/zabor-app-access.log combined;

    include /etc/nginx/mime.types;

    location ~* assets/i18n.*\.json$ {
        allow all;
    }

    location ~* (eval\-stdin\.php|1\.php|x\.js|\.cgi|\.php|\.json|\.exe|\.xml|\.env.*)$ {
        deny all;
    }

    location ~* .*\.js\.map$ {
        allow all;
    }

    location ~* /(owa|ecp|wsman|version|demo|cms|crm|admin|backup|blog|workspace|panel|containers|GponForm|cgi\-bin|remote|public|vendor|lib|laravel|phpunit|www|yii|zend|debug|hudson|druid|goform|wiki|teorema|ab2|hello|_prof|dana\-|waiting|razor|config|credential|secret|error|database|aws|appveyor|wercker|drone|semaphore|codeship|azure|Dockerfile|docker|k8s|kube|terraform|vercel|netlify|heroku|digit|cloud|next|vite|webpack|rollup|parcel|esbuild|snowpack|tailwind|postcss|babel|upl|Prod|prod|gcp|system|variable|output|provider|version|data|local|control|console|root|sys|manag|alive|setup|install|upgra|resto|mysql|postgre|pgsql|sqlit|maria|mssql|oracl|mongo|elast|cassan|couch|influx|expres|koa|django|flask|spring|hibernat|asp|dot|rail|sinat|gin|echo|actix|warp|node|storage|stag|requir|packa|compos|db|tmp|temp|laravel|smtp|php|info|_prof|form|t4|geo|developmentserver|web|Remote|RDWeb|manage|doc|password|shell|subdomain|HNAP1|src|shop|server|upload|port|prot|user) {
        deny all;
    }

#     location ~* ^/(api|v1|v2|ws|login|setting|updat|times|test|app) {
#         deny all;
#     }
    location ~ ^/(main|common|polyfills|runtime|\d+)-es(.*).js$ {
        allow all;
    }
    location ~ ^/(main|common|polyfills|runtime|\d+)(.*) {
        deny all;
    }
    location ~ ^/api(.*) {
        deny all;
    }
    location ~ ^/v1(.*){
        deny all;
    }
    location ~ ^/v2(.*){
        deny all;
    }
    location ~ ^/ws(.*){
        deny all;
    }
    location ~ ^/login(.*) {
        deny all;
    }
    location ~ ^/setting(.*) {
        deny all;
    }
    location ~ ^/updat(.*) {
        deny all;
    }
    location ~ ^/times(.*) {
        deny all;
    }
    location ~ ^/test(.*) {
        deny all;
    }
    location ~ ^/app(.*) {
        deny all;
    }
    location ~ ^/cache(.*) {
        deny all;
    }
    location ~ ^/dump(.*) {
        deny all;
    }
    location ~ ^/mail(.*) {
        deny all;
    }
    location ~ ^/redis(.*) {
        deny all;
    }

    location ~* /(\.ssh|\.ssl|\.docker|\.codeship|\.travis|\.circl|\.github|\.env|\.npm|\.yarn|\._wp|\.aws|\.git|\.docker|\.babel|\.well\-known|\+CSCOE\+) {
        deny all;
    }

    location ~* /(\*\.env|\*\.bak|\*\.old|\*\.sav|\*\.tmp|\*\.swp|\*\.orig|\*\.cop|\*\.swp) {
        deny all;
    }
    # index
    # //admin/login|//webpages

    # serve static files directly
    location ~* \.(jpg|jpeg|png|gif|webp|mp3|mp4|webm|mov|avi|wmv|mkv|ogg|pdf|doc|docx|xls|xlsx|css)$ {
        access_log off;
        #expires max;
    }

    location / {
      # First attempt to serve request as file, then
      # as directory, then fall back to displaying a 404.
      try_files $uri /index.html =404;
    }

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    location ~ /\.ht {
       deny all;
    }

    # Block access to .hidden files
    location ~ /\. {
        deny all;
    }
}
